# Домашнее задание к занятию "13.Системы мониторинга" - `Rashevchenko Mikhail`

## Обязательные задания

1. Вас пригласили настроить мониторинг на проект. На онбординге вам рассказали, что проект представляет из себя 
платформу для вычислений с выдачей текстовых отчетов, которые сохраняются на диск. Взаимодействие с платформой 
осуществляется по протоколу http. Также вам отметили, что вычисления загружают ЦПУ. Какой минимальный набор метрик вы
выведите в мониторинг и почему?

<details><summary>Ответ:</summary>
  
+ CPU Utilization (Использование ЦПУ) - Ключевая метрика, вычислениях которые загружают ЦПУ - необходимо контролировать.    
+ Память (RAM) Utilization (Использование памяти) - Мониторинг оперативной памяти для контроля количество доступной память, при максимальных значениях может привести к снижению производительности или к падению системы.     
+ Использование диска (Disk Utilization) - Отслеживание использования дискового пространства для предотвращения переполнение диска и потери данных.    
+ Загрузка сети (Network Throughput) - Отслеживание объема сетевого трафика, если взаимодействие с платформой осуществляется по протоколу HTTP.    
+ Логи ошибок (Error Logs) - Отслеживание ошибок и исключений в логах.    
+ Метрики доступности (Availability Metrics) - Мониторинг доступности платформы для обеспечения работы, а именно для проверки статуса серверов и уведомлений в случае отказа.

</details>

#
2. Менеджер продукта посмотрев на ваши метрики сказал, что ему непонятно что такое RAM/inodes/CPUla. Также он сказал, 
что хочет понимать, насколько мы выполняем свои обязанности перед клиентами и какое качество обслуживания. Что вы 
можете ему предложить?

<details><summary>Ответ:</summary>
  
+ RAM (Random Access Memory) - объем оперативной памяти, используемый сервером или приложением.
+ Inodes - структуры данных в файловой системе, которые отслеживают информацию о файлах и каталогах.
+ CPUla (CPU Load Average) - средняя нагрузка на процессор системы.
Метрики берем из приложения или БД.  

</details>

#
3. Вашей DevOps команде в этом году не выделили финансирование на построение системы сбора логов. Разработчики в свою 
очередь хотят видеть все ошибки, которые выдают их приложения. Какое решение вы можете предпринять в этой ситуации, 
чтобы разработчики получали ошибки приложения?

<details><summary>Ответ:</summary>
  
Можно воспользоваться бесплатными облачными сервисами хранения метрик, например ElasticSearch (Но я бы задумался о такой организации)

</details>

#
4. Вы, как опытный SRE, сделали мониторинг, куда вывели отображения выполнения SLA=99% по http кодам ответов. 
Вычисляете этот параметр по следующей формуле: summ_2xx_requests/summ_all_requests. Данный параметр не поднимается выше 
70%, но при этом в вашей системе нет кодов ответа 5xx и 4xx. Где у вас ошибка?

<details><summary>Ответ:</summary>
  
В данном случае, формула summ_2xx_requests/summ_all_requests оценивает только процент успешных запросов (HTTP 2xx). Она не учитывает другие коды ответов, такие как 3xx (перенаправления) и 1xx (информационные ответы).
Для вычисления общего SLA, включая все категории кодов ответов, следует использовать следующую формулу:

SLA = (summ_2xx_requests + summ_3xx_requests + summ_1xx_requests) / summ_all_requests

</details>

#
5. Опишите основные плюсы и минусы pull и push систем мониторинга.

<details><summary>Ответ:</summary>
  
"Pull системы мониторинга:"  

Плюсы:
+ Сниженная нагрузка на целевые системы: В pull-системах мониторинга, мониторинговые агенты (клиенты) опрашивают целевые системы (серверы) по запросу, что позволяет более точно контролировать частоту опроса и снижает нагрузку на целевые системы. Это особенно полезно для высоконагруженных приложений.
+ Более простая настройка и установка: Pull-системы часто проще настраивать и устанавливать, так как агенты мониторинга могут быть легко развернуты на целевых серверах без дополнительных настроек на стороне сервера.
+ Прозрачность для целевых систем: Целевые системы могут быть неосведомленными о наличии мониторинга и агентов, что может быть полезно в некоторых ситуациях для соблюдения конфиденциальности.+ 

Минусы:
+ Задержка в обновлении данных: Поскольку мониторинговые агенты опрашивают целевые системы по расписанию, существует задержка в обновлении данных. Это может снизить способность обнаружения проблем в режиме реального времени.
+ Потеря данных: Если агент неспособен опросить целевую систему (например, из-за сетевой проблемы или сбоя агента), это может привести к потере данных мониторинга.

"Push системы мониторинга:"

Плюсы:
+ Реальное время: Push-системы мониторинга позволяют отправлять данные в реальном времени, что делает их более подходящими для мониторинга важных событий и реагирования на них мгновенно.
+ Легкость настройки центрального сервера: В push-системах, центральный сервер (коллектор данных) более централизован и может быть легче настроен для обработки данных от множества клиентских систем.
+ Уведомления в режиме реального времени: Push-системы могут легко отправлять уведомления и события в реальном времени на основе данных мониторинга.

Минусы:
+ Высокая нагрузка на целевые системы: При использовании push-систем могут возникнуть проблемы с нагрузкой на целевые системы, особенно если большое количество данных отправляется в реальном времени.
+ Сложность настройки агентов: Настройка и установка агентов на целевых серверах может быть более сложной и требовательной к ресурсам процедурой.
+ Безопасность и приватность: Push-системы требуют от целевых систем предоставлять доступ для приема данных мониторинга, что может повысить риски вопросов безопасности и приватности.

</details>

#
6. Какие из ниже перечисленных систем относятся к push модели, а какие к pull? А может есть гибридные?

    - Prometheus 
    - TICK
    - Zabbix
    - VictoriaMetrics
    - Nagios

<details><summary>Ответ:</summary>
  
+ Prometheus - типовые сценарии используют pull модель, но есть специфичные с использованием push  
+ TICK - push    
+ Zabbix - pull + push  
+ VictoriaMetrics - pull + push  
+ Nagios - push  

</details>


#
7. Склонируйте себе [репозиторий](https://github.com/influxdata/sandbox/tree/master) и запустите TICK-стэк, 
используя технологии docker и docker-compose.

В виде решения на это упражнение приведите скриншот веб-интерфейса ПО chronograf (`http://localhost:8888`). 

P.S.: если при запуске некоторые контейнеры будут падать с ошибкой - проставьте им режим `Z`, например
`./data:/var/lib:Z`

<details><summary>Ответ:</summary>
  
![image](https://github.com/mrashevchenko/gitlab-hw/assets/100411467/7e19dfae-f05f-479f-b093-3d76b526cf64)

</details>

#
8. Перейдите в веб-интерфейс Chronograf (http://localhost:8888) и откройте вкладку Data explorer.
        
    - Нажмите на кнопку Add a query
    - Изучите вывод интерфейса и выберите БД telegraf.autogen
    - В `measurments` выберите cpu->host->telegraf-getting-started, а в `fields` выберите usage_system. Внизу появится график утилизации cpu.
    - Вверху вы можете увидеть запрос, аналогичный SQL-синтаксису. Поэкспериментируйте с запросом, попробуйте изменить группировку и интервал наблюдений.

Для выполнения задания приведите скриншот с отображением метрик утилизации cpu из веб-интерфейса.

<details><summary>Ответ:</summary>
  
![image](https://github.com/mrashevchenko/gitlab-hw/assets/100411467/f636a32c-3e2e-44df-8f2c-a089dc6a8192)
  
</details>


#
9. Изучите список [telegraf inputs](https://github.com/influxdata/telegraf/tree/master/plugins/inputs). 
Добавьте в конфигурацию telegraf следующий плагин - [docker](https://github.com/influxdata/telegraf/tree/master/plugins/inputs/docker):
```
[[inputs.docker]]
  endpoint = "unix:///var/run/docker.sock"
```

Дополнительно вам может потребоваться донастройка контейнера telegraf в `docker-compose.yml` дополнительного volume и 
режима privileged:
```
  telegraf:
    image: telegraf:1.4.0
    privileged: true
    volumes:
      - ./etc/telegraf.conf:/etc/telegraf/telegraf.conf:Z
      - /var/run/docker.sock:/var/run/docker.sock:Z
    links:
      - influxdb
    ports:
      - "8092:8092/udp"
      - "8094:8094"
      - "8125:8125/udp"
```

После настройке перезапустите telegraf, обновите веб интерфейс и приведите скриншотом список `measurments` в 
веб-интерфейсе базы telegraf.autogen . Там должны появиться метрики, связанные с docker.

Факультативно можете изучить какие метрики собирает telegraf после выполнения данного задания.

<details><summary>Ответ:</summary>  

![image](https://github.com/mrashevchenko/gitlab-hw/assets/100411467/7d04cdfb-07c2-4aad-b55d-f5893b44f7f0)

</details>

